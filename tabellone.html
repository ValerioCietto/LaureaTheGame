<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Tabellone Accademico - Laurea the Game</title>
  <style>
    body { font-family: sans-serif; background: #f5f5f5; display: flex; flex-direction: column; align-items: center; padding: 20px; }
    .board { display: grid; grid-template-columns: repeat(6, 140px); grid-template-rows: repeat(4, 100px); gap: 6px; background: #fff; border-radius: 12px; box-shadow: 0 0 12px rgba(0,0,0,0.2); }
    .cell { position: relative; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; border-radius: 8px; font-weight: bold; font-size: 14px; color: white; padding: 6px; }
    .cell.player::after { content: ''; position: absolute; top: 4px; left: 4px; width: 12px; height: 12px; border-radius: 50%; background: white; }
    .lezioni { background-color: #268bd2; }
    .esami { background-color: #cb4b16; }
    .vacanza { background-color: #859900; }
    .imprevisto { background-color: #b58900; }
    .controls { display: flex; gap: 10px; margin: 20px 0; }
    .controls button { padding: 6px 12px; border: none; border-radius: 4px; background: #268bd2; color: white; font-weight: bold; cursor: pointer; }
    .controls button:disabled { background: #aaa; cursor: default; }
    .cards-container { display: flex; gap: 20px; width: 100%; max-width: 1000px; }
    .card { background: #fff; border-radius: 8px; box-shadow: 0 0 6px rgba(0,0,0,0.1); padding: 10px; flex: 1; }
    .card h3 { margin: 0 0 10px; font-size: 16px; text-align: center; }
    .card ul { list-style: none; padding: 0; margin: 0; }
    .card ul li { margin: 4px 0; display: flex; justify-content: space-between; align-items: center; }
    #esame-select { width: 100%; padding: 4px; margin-bottom: 10px; font-size: 14px; }
    dialog { padding: 20px; border: none; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.3); }
    dialog h3 { margin-top: 0; }
    select { width: 100%; margin: 10px 0; }
    button.dialog { margin-top: 10px; }
    #testo-content { white-space: pre-wrap; max-height: 200px; overflow: auto; margin-bottom: 10px; border: 1px solid #ccc; padding: 10px; }
  </style>
</head>
<body>
  <div class="board" id="board"></div>
  <div class="controls">
    <button id="advance-button">Avanza di 14 giorni</button>
    <button id="frequenta-button" disabled>Frequenta Lezione</button>
    <button id="dai-esame-button">Dai esame</button>
    <button id="studio-button" disabled>Studio forsennato</button>
  </div>
  <div class="cards-container">
    <div class="card lezioni-card">
      <h3>Lezioni</h3>
      <ul id="lezioni-list"></ul>
    </div>
    <div class="card libretto-card">
      <h3>Libretto</h3>
      <ul id="libretto-list"></ul>
    </div>
    <div class="card esami-card">
      <h3>Esami</h3>
      <select id="esame-select"></select>
    </div>
  </div>
  <dialog id="lezione-dialog">
    <h3>Frequenta Lezione</h3>
    <select id="lezione-select" size="3"></select>
    <button id="lezione-confirm" class="dialog">Conferma</button>
  </dialog>
  <dialog id="testo-dialog">
    <h3>Testo paragrafo</h3>
    <div id="testo-content"></div>
    <button id="testo-close" class="dialog">Chiudi</button>
  </dialog>
  <script>
    // Includi esami.json come oggetto
    const examTexts = {
      "reti_neurali_da_pesca": {
        "cfu": 6,
        "text": [
          "Le reti neurali da pesca sono nate per applicare l’intelligenza artificiale all’ambito ittico e lacustre...",
          "Il modello più noto è il “Perceptron ad Amo Singolo”...",
          "Tra i problemi comuni c’è l’overfishing computazionale...",
          "I ricercatori stanno ora lavorando su reti generative..."
        ]
      },
      "albegra_della_pronuncia_basgliata": {
        "cfu": 12,
        "text": [
          "L’albegra, disciplina confusa fin dall’origine...",
          "Nella provincia di Basglia, la notazione classica...",
          "I teoremi vengono dimostrati tramite danze interpretative...",
          "In tempi recenti, la Facoltà di Albegra Application..."
        ]
      },
      "statistica_ad_mentula": {
        "cfu": 9,
        "text": [
          "La Statistica ad mentula è un campo controverso...",
          "Secondo il prof. Gennaro Casuale, una correlazione...",
          "Gli studenti raccolgono dati con dadi...",
          "La regola d’oro del corso è: se il dato non supporta la tesi..."
        ]
      }
    };
    // Setup
    const exams = [];
    const paragraphsUnlocked = {};
    function initExams() {
      Object.keys(examTexts).forEach(key => {
        exams.push({ name: key.replace(/_/g, ' '), key, cfu: examTexts[key].cfu });
      });
      exams.forEach(e => paragraphsUnlocked[e.key] = 0);
      populateExamSelect();
      updateLibretto();
      updateLezioni();
    }
    const maxParagraphs = key => examTexts[key].cfu / 3;
    let takenExams = [];
    const cellsDef = [
      { label: 'Ott 1', type: 'lezioni' },
      { label: 'Ott 2', type: 'lezioni' },
      { label: 'Nov 1', type: 'lezioni' },
      { label: 'Nov 2', type: 'imprevisto' },
      { label: 'Dic 1', type: 'lezioni' },
      { label: 'Dic 2', type: 'lezioni' },
      { label: 'Gen 1', type: 'esami' },
      { label: 'Gen 2', type: 'esami' },
      { label: 'Feb 1', type: 'lezioni' },
      { label: 'Feb 2', type: 'lezioni' },
      { label: 'Mar 1', type: 'lezioni' },
      { label: 'Mar 2', type: 'lezioni' },
      { label: 'Apr 1', type: 'lezioni' },
      { label: 'Apr 2', type: 'lezioni' },
      { label: 'Mag 1', type: 'imprevisto' },
      { label: 'Mag 2', type: 'lezioni' },
      { label: 'Giu 1', type: 'lezioni' },
      { label: 'Giu 2', type: 'lezioni' },
      { label: 'Lug 1', type: 'esami' },
      { label: 'Lug 2', type: 'esami' },
      { label: 'Ago 1', type: 'vacanza' },
      { label: 'Ago 2', type: 'vacanza' },
      { label: 'Set 1', type: 'esami' },
      { label: 'Set 2', type: 'esami' }
    ];
    let currentCell = 0;
    const board = document.getElementById('board'), boardCells = [];
    function initBoard() {
      cellsDef.forEach((c,i) => {
        const cell = document.createElement('div');
        cell.classList.add('cell', c.type);
        cell.innerHTML = `${c.label}<br><small>${c.type==='lezioni'?'lezione':c.type==='esami'?'sessione esami':c.type==='vacanza'?'vacanza':'Imprevisto'}</small>`;
        board.appendChild(cell);
        boardCells.push(cell);
      });
      boardCells[0].classList.add('player');
    }
    function updateControlli() {
      const type = cellsDef[currentCell].type;
      document.getElementById('frequenta-button').disabled = type !== 'lezioni';
      document.getElementById('dai-esame-button').disabled = type !== 'esami';
      document.getElementById('studio-button').disabled = type !== 'vacanza';
    }

function updateLezioni() {
      const list = document.getElementById('lezioni-list');
      list.innerHTML = '';
      exams.slice(0, 4).forEach(e => {
        const li = document.createElement('li');
        li.innerText = `${e.name}: ${paragraphsUnlocked[e.key]}/${maxParagraphs(e.key)}`;
        if (paragraphsUnlocked[e.key] > 0) {
          const btn = document.createElement('button');
          btn.innerText = 'Vedi testo';
          btn.onclick = () => showTesto(e.key);
          li.appendChild(btn);
        }
        list.appendChild(li);
      });
    }
    function updateLibretto() {
      const list = document.getElementById('libretto-list');
      list.innerHTML = '';
      exams.forEach(e => {
        if (!takenExams.includes(e.key)) {
          const li = document.createElement('li');
          li.innerText = `${e.name} - ${examTexts[e.key].cfu} CFU`;
          list.appendChild(li);
        }
      });
    }
    function populateExamSelect() {
      const sel = document.getElementById('esame-select');
      sel.innerHTML = '';
      exams.forEach(e => {
        const o = document.createElement('option');
        o.value = e.key;
        o.innerText = `${e.name} (${e.cfu} CFU)`;
        sel.appendChild(o);
      });
    }
    function showTesto(key) {
      const dialog = document.getElementById('testo-dialog');
      const content = document.getElementById('testo-content');
      // Ottieni i paragrafi sbloccati
      const unlocked = paragraphsUnlocked[key];
      const texts = examTexts[key].text.slice(0, unlocked);
      // Mostra i paragrafi
      content.textContent = texts.join("

");
      dialog.showModal();
    }
function shuffle(a) {
      // Fisher–Yates shuffle
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
    }
    document.addEventListener('DOMContentLoaded', () => {
      initBoard(); initExams(); updateControlli();
      // Controls handlers...
    });
  </script>
</body>
</html>
